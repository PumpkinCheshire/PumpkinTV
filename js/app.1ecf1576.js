(function(e){function t(t){for(var s,r,o=t[0],c=t[1],u=t[2],l=0,m=[];l<o.length;l++)r=o[l],Object.prototype.hasOwnProperty.call(a,r)&&a[r]&&m.push(a[r][0]),a[r]=0;for(s in c)Object.prototype.hasOwnProperty.call(c,s)&&(e[s]=c[s]);d&&d(t);while(m.length)m.shift()();return i.push.apply(i,u||[]),n()}function n(){for(var e,t=0;t<i.length;t++){for(var n=i[t],s=!0,o=1;o<n.length;o++){var c=n[o];0!==a[c]&&(s=!1)}s&&(i.splice(t--,1),e=r(r.s=n[0]))}return e}var s={},a={app:0},i=[];function r(t){if(s[t])return s[t].exports;var n=s[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.m=e,r.c=s,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var s in e)r.d(n,s,function(t){return e[t]}.bind(null,s));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/PumpkinTV/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var d=c;i.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("56d7")},"019b":function(e,t,n){"use strict";n("f236")},"034f":function(e,t,n){"use strict";n("85ec")},"235e":function(e,t,n){"use strict";n("51a2")},2387:function(e,t,n){"use strict";n.r(t);n("99af"),n("4de4"),n("7db0"),n("4160"),n("d81d"),n("13d5"),n("a434"),n("b0c0"),n("d3b7"),n("3ca3"),n("159b"),n("ddb0"),n("96cf");var s=n("1da1"),a=n("4360"),i=n("0f97"),r=i("json");function o(e){return c.apply(this,arguments)}function c(){return c=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].getters.getAPI;case 2:return n=e.sent,e.next=5,r("https://api.themoviedb.org/3/tv/".concat(t,"?api_key=").concat(n,"&language=en-US"));case 5:return i=e.sent,e.next=8,Promise.all(i.seasons.map(function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(s){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r("https://api.themoviedb.org/3/tv/".concat(t,"/season/").concat(s.season_number,"?api_key=").concat(n,"&language=en-US"));case 2:return a=e.sent,e.prev=3,e.next=6,a.episodes;case 6:s.episodes=e.sent,e.next=11;break;case 9:e.prev=9,e.t0=e["catch"](3);case 11:return e.next=13,Promise.all(s.episodes.map((function(e){delete e.crew,delete e.guest_stars,0===e.season_number&&(e.total_number=e.episode_number),1===e.season_number&&(e.total_number=e.episode_number),e.total_number=i.seasons.filter((function(t){return t.season_number<e.season_number&&t.season_number>0})).reduce((function(e,t){return e+t.episode_count}),0)+e.episode_number})));case 13:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}()));case 8:if(e.prev=8,1===i.seasons.find((function(e){return e.season_number>1})).episodes[0].episode_number){e.next=16;break}return e.next=12,Promise.all(i.seasons.filter((function(e){return e.season_number>1})).map((function(e){e.episodes.map((function(e){e.season_number=1})),i.seasons.find((function(e){return 1===e.season_number})).episodes=i.seasons.find((function(e){return 1===e.season_number})).episodes.concat(e.episodes),i.seasons.find((function(e){return 1===e.season_number})).episode_count=i.seasons.find((function(e){return 1===e.season_number})).episodes.length})));case 12:i.seasons.splice(0==i.seasons[0].season_number?2:1),console.log(i.seasons[0].season_number),i.seasons.find((function(e){return 1===e.season_number})).episodes.forEach((function(e){return e.total_number=e.episode_number})),i.seasons.find((function(e){return 1===e.season_number})).name="Season 1";case 16:e.next=20;break;case 18:e.prev=18,e.t0=e["catch"](8);case 20:return e.next=22,JSON.parse(JSON.stringify(i));case 22:return e.abrupt("return",e.sent);case 23:case"end":return e.stop()}}),e,null,[[8,18]])}))),c.apply(this,arguments)}function u(e){return d.apply(this,arguments)}function d(){return d=Object(s["a"])(regeneratorRuntime.mark((function e(t){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].getters.getAPI;case 2:return n=e.sent,e.next=5,r("https://api.themoviedb.org/3/movie/".concat(t,"?api_key=").concat(n,"&language=en-US"));case 5:return s=e.sent,e.next=8,JSON.parse(JSON.stringify(s));case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)}))),d.apply(this,arguments)}t["default"]={genUpdater:o,genUpdaterMV:u}},"2bbc":function(e,t,n){},"3d49":function(e,t,n){"use strict";n("2bbc")},4360:function(e,t,n){"use strict";n("a623"),n("4de4"),n("7db0"),n("c740"),n("d81d"),n("13d5"),n("fb6a"),n("45fc"),n("a434"),n("b0c0"),n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d");var s=n("ade3"),a=(n("96cf"),n("1da1")),i=n("2b0e"),r=n("2f62"),o=n("bfa9"),c=n("a002"),u=n.n(c),d=n("2ef0"),l=n.n(d);i["default"].use(r["a"]);var m=new r["a"].Store({state:{userData:{tvs:[],mvs:[]},api_key:"",username:"",avatar:"",token:"",gist:"",loginCode:"",mode:!1,tvSort:"LE",tvSearch:"",tvMode:"catching",mvSort:"LE",mvSearch:"",mvMode:"listed"},getters:{getGist:function(e){return e.gist},getToken:function(e){return e.token},getMode:function(e){return e.mode},getMVMode:function(e){return e.mvMode},getMVSearch:function(e){return e.mvSearch},getMVSort:function(e){return e.mvSort},getTVMode:function(e){return e.tvMode},getTVSearch:function(e){return e.tvSearch},getTVSort:function(e){return e.tvSort},getAPI:function(e){return e.api_key},getUsername:function(e){return e.username},getAvatar:function(e){return e.avatar},getTVNumber:function(e){return e.userData.tvs.length},getMVNumber:function(e){return e.userData.mvs.length},getTVByIdx:function(e){return function(t){return e.userData.tvs[t]}},getMVByIdx:function(e){return function(t){return e.userData.mvs[t]}},getTotalWatchedTV:function(e){return e.userData.tvs.reduce((function(e,t){return e+t.seasons.reduce((function(e,t){return e+t.episodes.filter((function(e){return e.isFinished})).length}),0)}),0)},getTotalWatchedMV:function(e){return e.userData.mvs.reduce((function(e,t){return e+(t.isFinished?1:0)}),0)},getMVWatchedTime:function(e){var t=e.userData.mvs.reduce((function(e,t){return e+(t.isFinished?t.runtime:0)}),0),n=Math.floor(t/43200);t-=43200*n;var s=Math.floor(t/1440);t-=1440*s;var a=Math.floor(t/60);return[n,s,a]},getMVWatchedTimeBy:function(e){return function(t,n){Date.prototype.getWeekNumber=function(){var e=new Date(Date.UTC(this.getFullYear(),this.getMonth(),this.getDate())),t=e.getUTCDay()||7;e.setUTCDate(e.getUTCDate()+4-t);var n=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e-n)/864e5+1)/7)};var s=e.userData.mvs.filter((function(e){return e.isFinished&&0==t?new Date(e.finishedDate).getTime()>(new Date).getTime()-1051e7&&new Date(e.finishedDate).getWeekNumber()==n:1==t?new Date(e.finishedDate).getTime()>=(new Date).getTime()-3469e7&&new Date(e.finishedDate).getMonth()==n:new Date(e.finishedDate).getFullYear()==n}));return Math.floor(s.reduce((function(e,t){return e+t.runtime}),0)/60)}},getMVWatchedNumberBy:function(e){return function(t,n){return Date.prototype.getWeekNumber=function(){var e=new Date(Date.UTC(this.getFullYear(),this.getMonth(),this.getDate())),t=e.getUTCDay()||7;e.setUTCDate(e.getUTCDate()+4-t);var n=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e-n)/864e5+1)/7)},e.userData.mvs.filter((function(e){return e.isFinished&&0==t?new Date(e.finishedDate).getTime()>(new Date).getTime()-1051e7&&new Date(e.finishedDate).getWeekNumber()==n:1==t?new Date(e.finishedDate).getTime()>=(new Date).getTime()-3469e7&&new Date(e.finishedDate).getMonth()==n:new Date(e.finishedDate).getFullYear()==n})).length}},getTVWatchedNumberBy:function(e){return function(t,n){return Date.prototype.getWeekNumber=function(){var e=new Date(Date.UTC(this.getFullYear(),this.getMonth(),this.getDate())),t=e.getUTCDay()||7;e.setUTCDate(e.getUTCDate()+4-t);var n=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e-n)/864e5+1)/7)},e.userData.tvs.reduce((function(e,s){return e+s.seasons.reduce((function(e,s){return e+s.episodes.filter((function(e){return e.isFinished&&0==t?new Date(e.finishedDate).getTime()>(new Date).getTime()-1051e7&&new Date(e.finishedDate).getWeekNumber()==n:1==t?new Date(e.finishedDate).getTime()>=(new Date).getTime()-3469e7&&new Date(e.finishedDate).getMonth()==n:new Date(e.finishedDate).getFullYear()==n})).length}),0)}),0)}},getTVWatchedTimeBy:function(e){return function(t,n){return Date.prototype.getWeekNumber=function(){var e=new Date(Date.UTC(this.getFullYear(),this.getMonth(),this.getDate())),t=e.getUTCDay()||7;e.setUTCDate(e.getUTCDate()+4-t);var n=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e-n)/864e5+1)/7)},e.userData.tvs.reduce((function(e,s){return e+s.seasons.reduce((function(e,s){return e+s.episodes.filter((function(e){return e.isFinished&&0==t?new Date(e.finishedDate).getTime()>(new Date).getTime()-1051e7&&new Date(e.finishedDate).getWeekNumber()==n:1==t?new Date(e.finishedDate).getTime()>=(new Date).getTime()-3469e7&&new Date(e.finishedDate).getMonth()==n:new Date(e.finishedDate).getFullYear()==n})).length}),0)}),0)}},getTVWatchedTime:function(){return[0,0,0]},getTVIdxByID:function(e){return function(t){return e.userData.tvs.findIndex((function(e){return e.id===t}))}},getMVIdxByID:function(e){return function(t){return e.userData.mvs.findIndex((function(e){return e.id===t}))}},getTVIDByIdx:function(e){return function(t){return e.userData.tvs[t].id}},getMVIDByIdx:function(e){return function(t){return e.userData.mvs[t].id}},getSeasonByIdx:function(e){return function(t,n){return e.userData.tvs[t].seasons[n]}},getSeasonIdxByNumber:function(e){return function(t,n){return e.userData.tvs[t].seasons.findIndex((function(e){return e.season_number===n}))}},getEpisodeIdxByNumber:function(e){return function(t,n,s){return e.userData.tvs[t].seasons[n].episodes.findIndex((function(e){return e.episode_number===s}))}},getTVsByMode:function(e){return function(t){return"all"==t?e.userData.tvs:e.userData.tvs.filter((function(e){return e.mode===t}))}},getMVsByMode:function(e){return function(t){return"all"==t?e.userData.mvs:e.userData.mvs.filter((function(e){return e.mode===t}))}},getTVByID:function(e){return function(t){return e.userData.tvs.find((function(e){return e.id===t}))}},getTVLastUpDate:function(e){return function(t){return e.userData.tvs[t].lastUpDate}},getMVLastUpDate:function(e){return function(t){return e.userData.mvs[t].lastUpDate}},getUserData:function(e){return e.userData},getSaveData:function(e){return[e.userData.tvs.map((function(e){return[e.id,e.mode,new Date(e.addDate).toISOString().slice(0,10),null==e.finishedDate?"":new Date(e.finishedDate).toISOString().slice(0,10),e.where_am_i.id,e.seasons.map((function(e){return[null==e.finishedDate?"":new Date(e.finishedDate).toISOString().slice(0,10),e.confidentEpisode,e.episodes.map((function(e){return null==e.finishedDate?"":new Date(e.finishedDate).toISOString().slice(0,10)}))]}))]})),e.userData.mvs.map((function(e){return[e.id,e.mode,new Date(e.addDate).toISOString().slice(0,10),null==e.finishedDate?"":new Date(e.finishedDate).toISOString().slice(0,10)]}))]},isAddable:function(e){return function(t){if(0===t)return!1;if(e.mode){var n=e.userData.tvs.findIndex((function(e){return e.id==t}));return!(n>=0)||n}var s=e.userData.mvs.findIndex((function(e){return e.id==t}));return!(s>=0)||s}},isAllable:function(e){return function(t){var n=t.tvid,s=t.season_number,a=t.episode_number,i=e.userData.tvs.findIndex((function(e){return e.id===n})),r=e.userData.tvs[i].seasons.findIndex((function(e){return e.season_number===s}));return s>1&&a>1?!(e.userData.tvs[i].seasons.filter((function(e){return 0!==e.season_number&&e.season_number<s})).every((function(e){return e.isFinished}))&&e.userData.tvs[i].seasons[r].episodes.filter((function(e){return e.episode_number<a})).every((function(e){return e.isFinished}))):s>1&&1==a?!e.userData.tvs[i].seasons.filter((function(e){return 0!==e.season_number&&e.season_number<s})).every((function(e){return e.isFinished})):1===s&&a>1&&!e.userData.tvs[i].seasons[r].episodes.filter((function(e){return e.episode_number<a})).every((function(e){return e.isFinished}))}}},mutations:{setGist:function(e,t){e.gist=t},setAccessToken:function(e,t){e.token=t},setApiKey:function(e,t){t="49ae83b320a43c660d6fa4b4dae9ea79",e.api_key=t},setUsername:function(e,t){e.username=t},changeMode:function(e){e.mode=!e.mode,e.tvSearch="",e.mvSearch=""},addTV:function(e,t){e.userData.tvs.unshift(t)},addMV:function(e,t){e.userData.mvs.unshift(t)},setAvatar:function(e,t){e.avatar=t},loadUserData:function(e,t){e.userData=t},updateTV:function(e,t){var n=t.updater,s=t.tvidx;l.a.merge(e.userData.tvs[s],n),e.userData.tvs[s].lastUpDate=JSON.parse(JSON.stringify(new Date))},updateMV:function(e,t){var n=t.updater,s=t.mvidx;l.a.merge(e.userData.mvs[s],n),e.userData.mvs[s].lastUpDate=JSON.parse(JSON.stringify(new Date))},markEpisodeFinished:function(e,t){var n=t.tvidx,s=t.seasonidx,a=t.episodeidx,i=t.curTime;e.userData.tvs[n].seasons[s].episodes[a].isFinished=!0,e.userData.tvs[n].seasons[s].episodes[a].finishedDate=i,e.userData.tvs[n].seasons[s].confidentEpisode=e.userData.tvs[n].seasons[s].episodes.findIndex((function(e){return 0==e.isFinished}))},markSeasonFinished:function(e,t){var n=t.tvidx,s=t.seasonidx,a=t.curTime;e.userData.tvs[n].seasons[s].isFinished=!0,e.userData.tvs[n].seasons[s].finishedDate=a},markTVFinished:function(e,t){var n=t.tvidx,s=t.curTime;e.userData.tvs[n].isFinished=!0,e.userData.tvs[n].finishedDate=s},changeEpisodeFinishedDate:function(e,t){var n=t.tvidx,s=t.seasonidx,a=t.episodeidx,i=t.date;e.userData.tvs[n].seasons[s].episodes[a].finishedDate=i,e.userData.tvs[n].seasons[s].isFinished&&(e.userData.tvs[n].seasons[s].finishedDate=Math.max.apply(Math,e.userData.tvs[n].seasons[s].episodes.map((function(e){return new Date(e.finishedDate).getTime()})))),e.userData.tvs[n].isfinished&&(e.userData.tvs[n].finishedDate=Math.max.apply(Math,e.userData.tvs[n].seasons.map((function(e){return new Date(e.finishedDate).getTime()})))),e.userData.tvs[n].seasons[s].episodes[a].id==e.userData.tvs[n].where_am_i.id&&(e.userData.tvs[n].where_am_i.finishedDate=i)},markMVFinished:function(e,t){var n=t.mvidx,s=t.curTime;e.userData.mvs[n].isFinished=!0,e.userData.mvs[n].finishedDate=s,e.userData.mvs[n].mode="watched"},unmarkEpisode:function(e,t){var n=t.tvidx,s=t.seasonidx,a=t.episodeidx;e.userData.tvs[n].seasons[s].episodes[a].isFinished=!1,e.userData.tvs[n].seasons[s].episodes[a].finishedDate=null,e.userData.tvs[n].seasons[s].confidentEpisode=e.userData.tvs[n].seasons[s].episodes.findIndex((function(e){return 0==e.isFinished}))},unmarkSeason:function(e,t){var n=t.tvidx,s=t.seasonidx;e.userData.tvs[n].seasons[s].isFinished=!1,e.userData.tvs[n].seasons[s].finishedDate=null},unmarkTV:function(e,t){var n=t.tvidx;e.userData.tvs[n].isFinished=!1,e.userData.tvs[n].finishedDate=null},unmarkMV:function(e,t){var n=t.mvidx;e.userData.mvs[n].isFinished=!1,e.userData.mvs[n].finishedDate=null,e.userData.mvs[n].mode=new Date(e.userData.mvs[n].release_date).getTime()>(new Date).getTime()?"upcoming":"listed"},setWhereAmI:function(e,t){e.userData.tvs[t].where_am_i=e.userData.tvs[t].seasons.filter((function(e){return e.season_number>0&&e.episodes.some((function(e){return 1==e.isFinished}))})).slice(-1)[0].episodes.filter((function(e){return 1==e.isFinished})).slice(-1)[0],void 0==e.userData.tvs[t].where_am_i&&(e.userData.tvs[t].where_am_i=e.userData.tvs[t].seasons.find((function(e){return 1===e.season_number})).episodes.find((function(e){return 1===e.episode_number}))),console.log("seted where am i in",e.userData.tvs[t].name),console.log("I am",e.userData.tvs[t])},updateMode:function(e,t){"stopped"!==e.userData.tvs[t].mode&&("In Production"===e.userData.tvs[t].status?e.userData.tvs[t].mode="upcoming":!0!==e.userData.tvs[t].isFinished||"Ended"!=e.userData.tvs[t].status&&"Canceled"!=e.userData.tvs[t].status?e.userData.tvs[t].seasons.some((function(e){return 1==e.isFinished||e.episodes.some((function(e){return 1==e.isFinished}))}))?e.userData.tvs[t].last_episode_to_air.season_number<=e.userData.tvs[t].where_am_i.season_number&&e.userData.tvs[t].last_episode_to_air.episode_number<=e.userData.tvs[t].where_am_i.episode_number?e.userData.tvs[t].mode="following":new Date(e.userData.tvs[t].addDate).getTime()+12096e5>(new Date).getTime()||new Date(e.userData.tvs[t].where_am_i.finishedDate).getTime()+12096e5>(new Date).getTime()?e.userData.tvs[t].mode="catching":e.userData.tvs[t].mode="waiting":e.userData.tvs[t].mode="notstart":e.userData.tvs[t].mode="finished")},deleteTV:function(e,t){e.userData.tvs.splice(t,1)},deleteMV:function(e,t){e.userData.mvs.splice(t,1)},setProgress:function(e,t){var n=t.tvidx,s=t.percentage;e.userData.tvs[n].progress=s},setTVMode:function(e,t){e.tvMode=t},setTVSearch:function(e,t){e.tvSearch=t},setTVSort:function(e,t){e.tvSort=t},setMVMode:function(e,t){e.mvMode=t},setMVSearch:function(e,t){e.mvSearch=t},setMVSort:function(e,t){e.mvSort=t},changeMVFinishedDate:function(e,t){var n=t.mvidx,s=t.date;e.userData.mvs[n].finishedDate=s}},actions:{setAccessToken:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:console.log("start to process token",t),fetch("https://pumpkincors.herokuapp.com/http://github.com/login/oauth/access_token?client_id=4a56fb45e857832a9fae&client_secret=bf8e1facecb0f2dc01f4b7c40b594fd3f12cd285&code=".concat(t)).then((function(e){return e.text()})).then((function(t){console.log("got token",t),e.commit("setAccessToken",new URLSearchParams(t).get("access_token")),e.dispatch("setGist"),e.dispatch("setUsername")}));case 2:case"end":return n.stop()}}),n)})))()},setGist:function(e){return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:fetch("https://api.github.com/gists",{method:"GET",headers:{Accept:"application/vnd.github.v3+json",Authorization:"bearer ".concat(e.getters.getToken)}}).then((function(e){return e.json()})).then((function(t){t.some((function(e){return"PumpkinTVSave.json"in e.files}))?e.commit("setGist",t.find((function(e){return"PumpkinTVSave.json"in e.files})).id):fetch("https://api.github.com/gists",{method:"POST",headers:{Accept:"application/vnd.github.v3+json",Authorization:"bearer ".concat(e.getters.getToken," ")},body:JSON.stringify({description:"PumpkinTV saved progress",public:!1,files:Object(s["a"])({},"PumpkinTVSave.json",{content:""})})}).then((function(e){return e.json()})).then((function(t){return e.commit("setGist",t.id)}))}));case 1:case"end":return t.stop()}}),t)})))()},setApiKey:function(e,t){e.commit("setApiKey",t)},setUsername:function(e){return Object(a["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:fetch("https://api.github.com/user",{method:"GET",headers:{Accept:"application/vnd.github.v3+json",Authorization:"bearer ".concat(e.getters.getToken)}}).then((function(e){return e.json()})).then((function(t){e.commit("setUsername",t.login),e.commit("setAvatar",t.avatar_url)}));case 1:case"end":return t.stop()}}),t)})))()},recoverFromSave:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function s(){var i,r,o,c,u,d,l;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return i=n("2387").default.genUpdater,r=n("2387").default.genUpdaterMV,o=t[0],c=t[1],u=[],d=[],s.next=8,Promise.all(o.map(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,i(t[0]);case 2:return n=e.sent,n.isFinished=""!=t[3],n.mode=t[1],n.addDate=JSON.parse(JSON.stringify(new Date(t[2]))),n.finishedDate=""==t[3]?null:JSON.parse(JSON.stringify(new Date(t[3]))),n.where_am_i=n.seasons.find((function(e){return e.episodes.some((function(e){return e.id==t[4]}))})).episodes.find((function(e){return e.id==t[4]})),n.lastUpDate=JSON.parse(JSON.stringify(new Date)),e.next=11,Promise.all(n.seasons.map(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(n,s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(s<t[5].length)){e.next=6;break}return n.isFinished=""!=t[5][s][0],n.finishedDate=""==t[5][s][0]?null:JSON.parse(JSON.stringify(new Date(t[5][s][0]))),n.confidentEpisode=t[5][s][1],e.next=6,Promise.all(n.episodes.map(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(n,a){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n.isFinished=""!=t[5][s][2][a],n.finishedDate=""==t[5][s][2][a]?null:JSON.parse(JSON.stringify(new Date(t[5][s][2][a])));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()));case 11:u.push(n);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 8:return s.next=10,Promise.all(c.map(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,r(t[0]);case 2:n=e.sent,n.isFinished=""!=t[3],n.mode=t[1],n.finishedDate=""==t[3]?null:JSON.parse(JSON.stringify(new Date(t[3]))),n.addDate=JSON.parse(JSON.stringify(new Date(t[2]))),n.lastUpDate=JSON.parse(JSON.stringify(new Date)),d.push(n);case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 10:l={tvs:u,mvs:d},console.log("I am userData",l),e.commit("loadUserData",l);case 13:case"end":return s.stop()}}),s)})))()},addTV:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function s(){var i,r,o,c;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(i=n("2387").default.genUpdater,r=e.getters.isAddable(t),!1!==r){s.next=5;break}s.next=24;break;case 5:if(!0!==r){s.next=23;break}return s.next=8,i(t);case 8:return o=s.sent,c=JSON.parse(JSON.stringify(o)),c.isFinished="false",c.mode="catching",c.finishedDate=null,c.addDate=JSON.parse(JSON.stringify(new Date)),c.lastUpDate=JSON.parse(JSON.stringify(new Date)),s.next=17,Promise.all(c.seasons.map(function(){var e=Object(a["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.isFinished=!1,t.finishedDate=null,t.confidentEpisode=0,e.next=5,Promise.all(t.episodes.map((function(e){e.isFinished=!1,e.finishedDate=null})));case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 17:return s.next=19,c.seasons.find((function(e){return 1===e.season_number})).episodes.find((function(e){return 1===e.episode_number}));case 19:c.where_am_i=s.sent,e.commit("addTV",c),s.next=24;break;case 23:e.dispatch("updateTV",{tvidx:r,force:!1});case 24:case"end":return s.stop()}}),s)})))()},addMV:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function s(){var a,i,r,o;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(a=n("2387").default.genUpdaterMV,i=e.getters.isAddable(t),!1!==i){s.next=6;break}console.log("not addable no update"),s.next=19;break;case 6:if(!0!==i){s.next=18;break}return s.next=9,a(t);case 9:r=s.sent,o=JSON.parse(JSON.stringify(r)),o.isFinished=!1,o.mode=new Date(o.release_date).getTime()>(new Date).getTime()?"upcoming":"listed",o.finishedDate=null,o.addDate=JSON.parse(JSON.stringify(new Date)),e.commit("addMV",o),s.next=19;break;case 18:e.dispatch("updateMV",i);case 19:case"end":return s.stop()}}),s)})))()},updateTV:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function s(){var a,i,r,o,c,u;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(a=t.tvidx,i=t.force,console.log("updatetv",a),r=e.getters.getTVIDByIdx(a),!i){s.next=11;break}return o=n("2387").default.genUpdater,s.next=7,o(r);case 7:c=s.sent,e.commit("updateTV",{updater:c,tvidx:a}),s.next=20;break;case 11:if(!(new Date(e.getters.getTVLastUpDate(a)).getTime()>(new Date).getTime()-864e5)){s.next=15;break}console.log("too soon to update"),s.next=20;break;case 15:return u=n("2387").default.genUpdater,s.next=18,u(r);case 18:c=s.sent,e.commit("updateTV",{updater:c,tvidx:a});case 20:e.commit("updateMode",a);case 21:case"end":return s.stop()}}),s)})))()},updateMV:function(e,t){return Object(a["a"])(regeneratorRuntime.mark((function s(){var a,i,r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(a=e.getters.getMVIDByIdx(t),!new Date(e.getters.getMVLastUpDate(t).getTime()>(new Date).getTime()-864e5)){s.next=5;break}console.log("no change no update"),s.next=10;break;case 5:return i=n("2387").default.genUpdaterMV,s.next=8,i(a);case 8:r=s.sent,e.commit("updateMV",{updater:r,mvidx:t});case 10:case"end":return s.stop()}}),s)})))()},markWatched:function(e,t){var n=t.isAll,s=t.info,a=s.tvid,i=s.season_number,r=s.episode_number,o=JSON.parse(JSON.stringify(new Date)),c=e.getters.getTVIdxByID(a);console.log("markWatched",c),e.dispatch("updateTV",{tvidx:c,force:!1});var u=e.getters.getTVByID(a),d=e.getters.getSeasonIdxByNumber(c,i),l=e.getters.getEpisodeIdxByNumber(c,d,r);if(e.commit("markEpisodeFinished",{tvidx:c,seasonidx:d,episodeidx:l,curTime:o}),n){if(i>1)for(var m=0;m<d;m++){var p=e.getters.getSeasonByIdx(c,m);if(0!==p.season_number&&!0!==p.isFinished){for(var h=p.confidentEpisode;h<p.episode_count;h++)0==p.episodes[h].isFinished&&e.commit("markEpisodeFinished",{tvidx:c,seasonidx:m,episodeidx:h,curTime:o});e.commit("markSeasonFinished",{tvidx:c,seasonidx:m,curTime:o})}}for(var f=u.seasons[d].confidentEpisode;f<l;f++)e.commit("markEpisodeFinished",{tvidx:c,seasonidx:d,episodeidx:f,curTime:o})}e.getters.getSeasonByIdx(c,d).episodes.every((function(e){return e.isFinished}))&&e.commit("markSeasonFinished",{tvidx:c,seasonidx:d,curTime:o}),e.getters.getTVByIdx(c).seasons.filter((function(e){return e.season_number>0})).every((function(e){return e.isFinished}))&&e.commit("markTVFinished",{tvidx:c,curTime:o}),e.commit("setWhereAmI",c),e.commit("updateMode",c)},changeEpisodeFinishedDate:function(e,t){var n=t.tvidx,s=t.season_number,a=t.episode_number,i=t.date,r=e.getters.getSeasonIdxByNumber(n,s),o=e.getters.getEpisodeIdxByNumber(n,r,a);e.commit("changeEpisodeFinishedDate",{tvidx:n,seasonidx:r,episodeidx:o,date:i})},markWatchedMV:function(e,t){var n=JSON.parse(JSON.stringify(new Date)),s=e.getters.getMVIdxByID(t);e.commit("markMVFinished",{mvidx:s,curTime:n})},unmarkWatched:function(e,t){var n=t.tvid,s=t.season_number,a=t.episode_number,i=e.getters.getTVIdxByID(n),r=e.getters.getSeasonIdxByNumber(i,s),o=e.getters.getEpisodeIdxByNumber(i,r,a);e.commit("unmarkEpisode",{tvidx:i,seasonidx:r,episodeidx:o}),e.commit("unmarkSeason",{tvidx:i,seasonidx:r}),e.commit("unmarkTV",{tvidx:i}),e.commit("setWhereAmI",i),e.commit("updateMode",i)},unmarkWatchedMV:function(e,t){var n=e.getters.getMVIdxByID(t);e.commit("unmarkMV",{mvidx:n})},deleteTV:function(e,t){var n=e.getters.getTVIdxByID(t);e.commit("deleteTV",n)},deleteMV:function(e,t){var n=e.getters.getMVIdxByID(t);e.commit("deleteMV",n)},setProgress:function(e,t){var n=t.tvid,s=t.percentage,a=e.getters.getTVIdxByID(n);e.commit("setProgress",{tvidx:a,percentage:s})},changeMVFinishedDate:function(e,t){var n=t.mvidx,s=t.date;e.commit("changeMVFinishedDate",{mvidx:n,date:s})}},plugins:[new o["a"]({storage:u.a,asyncStorage:!0}).plugin]});t["a"]=m},"51a2":function(e,t,n){},"56d7":function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var s=n("2b0e"),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("router-view")},i=[],r=n("2877"),o={},c=Object(r["a"])(o,a,i,!1,null,null,null),u=c.exports,d=n("5c96"),l=n.n(d),m=(n("0fae"),n("b2d6")),p=n.n(m);s["default"].use(l.a,{locale:p.a});var h=n("4360"),f=n("8c4f"),g=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{attrs:{id:"app"}},[n("el-container",[n("el-header",[n("el-row",{staticClass:"row-bg-header",attrs:{gutter:20,type:"flex",justify:"space-between"}},[n("el-col",{staticStyle:{height:"40px"},attrs:{span:4}},[n("el-switch",{staticStyle:{padding:"10px"},attrs:{"active-color":"#13ce66","inactive-color":"#ff4949"},on:{change:e.changeMode},model:{value:e.tmode,callback:function(t){e.tmode=t},expression:"tmode"}}),n("span",{staticClass:"logo"},[e._v(" Pumpkin "+e._s(e.tmode?"TV":"Movie"))])],1),n("el-col",{attrs:{span:20}},[n("SearchBar",{on:{setSearch:function(t){e.search=t}}})],1),n("el-col",{staticClass:"function-bar",attrs:{span:6}},[n("FunctionBar")],1)],1)],1),n("el-container",{staticStyle:{"overflow-y":"hidden !important"}},[n("el-aside",{attrs:{width:"200px"}},[e.tmode?n("TVNavMenu"):n("MVNavMenu")],1),n("el-main",[e.tmode?n("TVTable"):n("MVTable")],1)],1)],1),n("Init")],1)},v=[],b=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-table",{directives:[{name:"el-table-infinite-scroll",rawName:"v-el-table-infinite-scroll",value:e.load,expression:"load"}],staticStyle:{display:"block","scroll-behavior":"smooth !important"},attrs:{"show-header":!1,data:e.tvs,height:"100vh","infinite-scroll-immediate":!1}},[n("el-table-column",{attrs:{label:"name"},scopedSlots:e._u([{key:"default",fn:function(e){return[n("TVCard",{attrs:{tvid:e.row.id}})]}}])})],1)},_=[],w=(n("4de4"),n("caad"),n("fb6a"),n("b0c0"),n("ac1f"),n("2532"),n("841c"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",{staticClass:"row-bg-card",attrs:{type:"flex",justify:"space-around"}},[n("el-col",{attrs:{span:22}},[n("el-card",{attrs:{shadow:"hover","body-style":{padding:"0px"}}},[n("el-row",{attrs:{gutter:20}},[n("el-col",{class:{backdrop_col_expand:e.expand,backdrop_col:!e.expand},attrs:{span:8},nativeOn:{click:function(t){e.expand=!e.expand}}},[n("transition",{attrs:{name:"fade",mode:"out-in"}},[e.expand?n("el-image",{key:"poster",staticStyle:{width:"100%",height:"100%"},attrs:{src:e.season_poster?e.genUrl(e.season_poster):e.genUrl(e.tv.poster_path)}}):n("el-image",{key:"backdrop",staticStyle:{width:"100%",height:"100%"},attrs:{src:e.genUrl(e.tv.backdrop_path)}})],1)],1),n("el-col",{staticClass:"title_col",attrs:{span:16}},[n("el-row",{attrs:{type:"flex",justify:"space-between"},on:{click:function(t){e.expand=!e.expand}}},[n("el-col",{staticClass:"show_title",attrs:{span:16}},[e._v(" "+e._s(e.tv.name)+" ")]),n("el-col",{staticClass:"show_rate",attrs:{span:8}},[n("el-rate",{attrs:{disabled:"","show-score":"",max:10,"text-color":"#ff9900","score-template":"{value}"},model:{value:e.tv.vote_average,callback:function(t){e.$set(e.tv,"vote_average",t)},expression:"tv.vote_average"}})],1)],1),n("el-row",{attrs:{type:"flex"}},[n("el-col",{attrs:{span:18}},[n("el-image",{staticStyle:{width:"48px",height:"16px","padding-right":"5px"},attrs:{src:e.tv.networks.length>0?e.genUrl(e.tv.networks[0].logo_path):"",fit:"scale-down"}}),n("el-divider",{attrs:{direction:"vertical"}}),n("span",[e._v(e._s(e.tv.status))])],1),n("el-col",{staticStyle:{"text-align":"right","padding-right":"20px"},attrs:{span:8}},[n("el-button",{staticStyle:{padding:"5px"},attrs:{icon:"el-icon-refresh",circle:""},on:{click:e.refresh}}),n("el-divider",{attrs:{direction:"vertical"}}),n("el-popconfirm",{attrs:{title:"Confirm to delete?","confirm-button-text":"Yes","cancel-button-text":"Cancel"},on:{confirm:e.deleteTV}},[n("el-button",{staticStyle:{padding:"5px"},attrs:{slot:"reference",type:"danger",icon:"el-icon-delete",circle:""},slot:"reference"})],1),n("el-divider",{attrs:{direction:"vertical"}}),n("span",[e._v(e._s(e.next.word))]),n("el-divider",{attrs:{direction:"vertical"}}),e.next.episode?n("el-button",{staticStyle:{padding:"5px"},attrs:{icon:"el-icon-check",type:"",circle:""},on:{click:function(t){return e.markWatched(e.next.episode.season_number,e.next.episode.episode_number,!1)}}}):e._e()],1)],1),n("el-row",{staticClass:"progress"},[n("el-progress",{attrs:{"text-inside":!0,"stroke-width":26,percentage:e.percentage}})],1),e.expand?n("el-row",{staticClass:"season_tab"},[n("SeasonTabs",{attrs:{seasons:e.tv.seasons,tvid:e.tvid},on:{passSeasonPoster:function(t){e.season_poster=t}}})],1):e._e()],1)],1)],1)],1)],1)}),D=[],x=(n("99af"),n("7db0"),n("13d5"),n("a9e3"),n("b680"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-tabs",{staticStyle:{},attrs:{type:"border-card"},on:{"tab-click":e.changeSeason},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.seasons,(function(t){return n("el-tab-pane",{key:t.id,ref:"tabs",refInFor:!0,attrs:{label:t.name,name:t.name,lazy:""}},[n("EpisodeCarousel",{attrs:{season:t,tvid:e.tvid}})],1)})),1)}),y=[],T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-carousel",{ref:"carousel",attrs:{autoplay:!1,loop:!1,type:"card",height:"175px","initial-index":e.slide-1,"indicator-position":"none"},on:{change:e.changeSlide}},e._l(e.season.episodes,(function(t){return n("el-carousel-item",{key:"carousel"+t.id,staticStyle:{"background-color":"grey","border-radius":"20px",border:"transparent"}},[n("EpisodeCard",{attrs:{episode:t,slide:e.slide,tvid:e.tvid,season:e.season}})],1)})),1),n("el-slider",{staticClass:"episode-slider",attrs:{step:1,max:e.season.episode_count,min:1,"show-input":""},on:{input:e.changeCarousel},model:{value:e.slide,callback:function(t){e.slide=t},expression:"slide"}})],1)},k=[],M=function(){var e=this,t=e.$createElement,n=e._self._c||t;return e.episode.episode_number>=e.slide-2&&e.episode.episode_number<=e.slide+2?n("el-card",{staticClass:"episode-card",style:"background-image: -webkit-cross-fade(url(data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/x8AAwMCAO+ip1sAAAAASUVORK5CYII=),url(https://image.tmdb.org/t/p/original"+(e.episode.still_path?e.episode.still_path:e.tv.backdrop_path)+"),30%);border:transparent;background-size:cover;background-repeat:no-repeat"},[n("el-row",{staticClass:"episode-card-title"},[n("span",[e._v(e._s("S"+e.getFormattedNumber(e.episode.season_number))+" ")]),n("el-divider",{staticClass:"SE-divider",attrs:{direction:"vertical"}}),n("span",[e._v(" "+e._s("E"+e.getFormattedNumber(e.episode.episode_number))+" ")]),n("span",[e._v("("+e._s(e.getTotalNumber(e.episode.season_number,e.episode.total_number))+")")]),n("el-divider",{staticClass:"title-divider",attrs:{direction:"vertical"}})],1),n("el-row",{staticStyle:{padding:"5px 0"}},[n("span",{staticStyle:{display:"inline-block","white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden",heigt:"16px",width:"420px"}},[e._v(e._s(e.episode.name))]),n("el-divider",{staticClass:"title-divider",attrs:{direction:"vertical"}}),n("i",{staticClass:"el-icon-date",staticStyle:{"margin-right":"5px"}}),n("span",[e._v(e._s(e.episode.air_date?e.episode.air_date.slice(0,10):"No air day yet"))])],1),n("el-row",{staticClass:"episode-overview"},[n("span",{staticStyle:{visibility:"visible"}},[e._v(e._s(e.episode.overview))])]),e.dateCompare(e.episode.air_date)?n("el-row",{staticClass:"mark-button"},[n("el-col",{staticStyle:{"line-height":"40px","padding-right":"10px"},attrs:{span:22}},[e.episode.isFinished?n("span",[e._v("Watched on ")]):e._e(),e.episode.isFinished?n("el-date-picker",{staticClass:"date-picker",attrs:{align:"right",type:"date",size:"mini","picker-options":e.pickerOptions},on:{change:e.changeFinishedDate},model:{value:e.finishedDate,callback:function(t){e.finishedDate=t},expression:"finishedDate"}}):e._e(),n("el-divider",{attrs:{direction:"vertical"}})],1),n("el-col",{attrs:{span:2}},[!e.episode.isFinished&&e.isAllable({tvid:e.tvid,season_number:e.season.season_number,episode_number:e.episode.episode_number})?n("el-popconfirm",{attrs:{"confirm-button-text":"Yes","cancel-button-text":"No",title:"Mark all previous episodes as watched？"},on:{confirm:function(t){return e.markWatched(e.season.season_number,e.episode.episode_number,!0)},cancel:function(t){return e.markWatched(e.season.season_number,e.episode.episode_number,!1)}}},[n("el-button",{attrs:{slot:"reference",icon:"el-icon-check",type:e.episode.isFinished?"primary":"",circle:"","data-season":e.season.season_number,"data-episode":e.episode.episode_number},slot:"reference"})],1):n("el-button",{attrs:{icon:"el-icon-check",type:e.episode.isFinished?"primary":"",circle:""},on:{click:function(t){e.episode.isFinished?e.unmarkWatched(e.season.season_number,e.episode.episode_number):e.markWatched(e.season.season_number,e.episode.episode_number,!1)}}})],1)],1):e._e()],1):e._e()},S=[],V={name:"EpisodeCard",props:{episode:Object,slide:Number,tvid:Number,season:Object},data:function(){var e=this;return{finishedDate:"",pickerOptions:{disabledDate:function(t){return t.getTime()>Date.now()||t.getTime()<new Date(e.episode.air_date).getTime()-864e5},shortcuts:[{text:"Today",onClick:function(e){e.$emit("pick",new Date)}},{text:"Yesterday",onClick:function(e){e.$emit("pick",(new Date).setTime((new Date).getTime()-864e5))}},{text:"Week Ago",onClick:function(e){e.$emit("pick",(new Date).setTime((new Date).getTime()-6048e5))}},{text:"Air Date",onClick:function(t){t.$emit("pick",e.episode.air_date)}}]}}},mounted:function(){this.finishedDate=this.episode.finishedDate},computed:{tvidx:function(){return this.$store.getters.getTVIdxByID(this.tvid)},isAllable:function(){return this.$store.getters.isAllable},tv:function(){return this.$store.getters.getTVByID(this.tvid)}},methods:{getFormattedNumber:function(e){return"".concat(e>9?e:"0"+e)},markWatched:function(e,t,n){this.finishedDate=new Date,this.$store.dispatch("markWatched",{isAll:n,info:{tvid:this.tvid,season_number:e,episode_number:t}})},unmarkWatched:function(e,t){this.$store.dispatch("unmarkWatched",{tvid:this.tvid,season_number:e,episode_number:t})},getTotalNumber:function(e,t){return 0===e?"SP".concat(this.getFormattedNumber(t)):"E".concat(this.getFormattedNumber(t))},dateCompare:function(e){return new Date(e).getTime()<(new Date).getTime()},changeFinishedDate:function(){this.$store.dispatch("changeEpisodeFinishedDate",{tvidx:this.tvidx,season_number:this.episode.season_number,episode_number:this.episode.episode_number,date:JSON.parse(JSON.stringify(this.finishedDate))})}}},C=V,$=Object(r["a"])(C,M,S,!1,null,null,null),O=$.exports,N={name:"EpisodeCarousel",props:{season:Object,tvid:Number},components:{EpisodeCard:O},data:function(){return{slide:0}},created:function(){this.slide=-1==this.season.confidentEpisode?this.season.episode_count:this.season.confidentEpisode+1},computed:{},methods:{changeCarousel:function(e){this.$refs.carousel.setActiveItem(e-1)},changeSlide:function(e){this.slide=e+1}}},F=N,I=(n("631e"),Object(r["a"])(F,T,k,!1,null,null,null)),A=I.exports,B={name:"SeasonTabs",props:{seasons:Array,tvid:Number},components:{EpisodeCarousel:A},created:function(){var e=this;this.activeName=this.seasons.find((function(t){return t.season_number===e.$store.getters.getTVByID(e.tvid).where_am_i.season_number})).name,this.$emit("passSeasonPoster",this.seasons.find((function(t){return t.season_number===e.$store.getters.getTVByID(e.tvid).where_am_i.season_number})).poster_path)},computed:{isAllable:function(){return this.$store.getters.isAllable}},methods:{changeSeason:function(e){this.$emit("passSeasonPoster",this.$store.getters.getTVByID(this.tvid).seasons[e.index].poster_path)}}},W=B,j=(n("bd05"),Object(r["a"])(W,x,y,!1,null,null,null)),U=j.exports,E={name:"TVCard",props:{tvid:Number},components:{SeasonTabs:U},data:function(){return{expand:!1,backdrop_url:"https://media.giphy.com/media/3oEjI6SIIHBdRxXI40/giphy.gif",poster_url:"https://media.giphy.com/media/3oEjI6SIIHBdRxXI40/giphy.gif",season_poster:"https://media.giphy.com/media/3oEjI6SIIHBdRxXI40/giphy.gif"}},computed:{tvidx:function(){return this.$store.getters.getTVIdxByID(this.tvid)},tv:function(){return this.$store.getters.getTVByIdx(this.tvidx)},percentage:function(e,t){return e=this.tv.seasons.filter((function(e){return 0!==e.season_number&&new Date(e.air_date)<new Date})).reduce((function(e,t){return e+t.episodes.filter((function(e){return new Date(e.air_date?e.air_date:"2099-12-31")<new Date})).length}),0),t=this.tv.seasons.filter((function(e){return 0!==e.season_number&&e.isFinished})).reduce((function(e,t){return e+t.episode_count}),0)+this.tv.seasons.filter((function(e){return 0!==e.season_number&&!e.isFinished})).reduce((function(e,t){return e+t.episodes.filter((function(e){return e.isFinished})).length}),0),this.$store.dispatch("setProgress",{tvid:this.tv.id,percentage:0!==e?parseFloat((t/e*100).toFixed(2)):0}),0!==e?parseFloat((t/e*100).toFixed(2)):0},next:function(){var e=this;return"finished"==this.tv.mode?{word:"You are finished",episode:null}:"following"==this.tv.mode||"upcoming"==this.tv.mode?this.tv.next_episode_to_air&&this.tv.next_episode_to_air.air_date?{word:"Next episode in ".concat(this.tv.next_episode_to_air.air_date," (").concat(Math.round((new Date(this.tv.next_episode_to_air.air_date).getTime()-(new Date).getTime())/864e5)," Days)"),episode:null}:{word:"Next episode TBD",episode:null}:"notstart"==this.tv.mode?{word:"Start Watch S01E01",episode:this.tv.seasons.find((function(e){return 1==e.season_number})).episodes.find((function(e){return 1==e.episode_number}))}:this.tv.where_am_i.episode_number==this.tv.seasons.find((function(t){return t.season_number==e.tv.where_am_i.season_number})).episode_count?{word:"Watch Next S".concat(this.tv.where_am_i.season_number+1,"E01"),episode:this.tv.seasons.find((function(t){return t.season_number==e.tv.where_am_i.season_number+1})).episodes[0]}:{word:"Watch Next S".concat(this.tv.where_am_i.season_number,"E").concat(this.tv.where_am_i.episode_number<100?("0"+(this.tv.where_am_i.episode_number+1)).slice(-2):this.tv.where_am_i.episode_number+1),episode:this.tv.seasons.find((function(t){return t.season_number==e.tv.where_am_i.season_number})).episodes.find((function(t){return t.episode_number==e.tv.where_am_i.episode_number+1}))}}},methods:{genUrl:function(e){return"https://image.tmdb.org/t/p/original".concat(e)},markWatched:function(e,t,n){this.$store.dispatch("markWatched",{isAll:n,info:{tvid:this.tvid,season_number:e,episode_number:t}})},deleteTV:function(){this.$store.dispatch("deleteTV",this.tvid)},refresh:function(){this.$store.dispatch("updateTV",{tvidx:this.tvidx,force:!0})}},mounted:function(){this.tvid=this.$store.getters.getTVIDByIdx(this.tvidx),this.$store.dispatch("updateTV",{tvidx:this.tvidx,force:!1})}},J=E,R=(n("3d49"),Object(r["a"])(J,w,D,!1,null,null,null)),P=R.exports,L=n("521e"),Y={name:"TVTable",components:{TVCard:P},data:function(){return{loader:4}},directives:{"el-table-infinite-scroll":L["a"]},methods:{load:function(){this.loader+=2}},computed:{mode:function(){return this.$store.getters.getTVMode},search:function(){return this.$store.getters.getTVSearch},sort:function(){var e={LE:function(e,t){return new Date(t.where_am_i.finishedDate).getTime()-new Date(e.where_am_i.finishedDate).getTime()},AZ:function(e,t){return e.name>t.name?1:t.name>e.name?-1:0},ZA:function(e,t){return e.name<t.name?1:t.name<e.name?-1:0},LH:function(e,t){return e.progress-t.progress},HL:function(e,t){return t.progress-e.progress},NO:function(e,t){return null!=e.next_episode_to_air&&null!=t.next_episode_to_air?new Date(e.next_episode_to_air.air_date).getTime()-new Date(t.next_episode_to_air.air_date).getTime():null==e.next_episode_to_air&&null==t.next_episode_to_air?0:null==e.next_episode_to_air?1:null==t.next_episode_to_air?-1:void 0},ON:function(e,t){return null!=e.next_episode_to_air&&null!=t.next_episode_to_air?new Date(t.next_episode_to_air.air_date).getTime()-new Date(e.next_episode_to_air.air_date).getTime():null==e.next_episode_to_air&&null==t.next_episode_to_air?0:null==e.next_episode_to_air?1:null==t.next_episode_to_air?-1:void 0}};return e[this.$store.getters.getTVSort]},tvs:function(){var e=this;return this.$store.getters.getTVsByMode(this.mode).filter((function(t){return t.name.toLowerCase().includes(e.search.toLowerCase())})).sort(this.sort).slice(0,this.loader)}}},G=Y,K=(n("235e"),Object(r["a"])(G,b,_,!1,null,null,null)),z=K.exports,H=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-table",{directives:[{name:"el-table-infinite-scroll",rawName:"v-el-table-infinite-scroll",value:e.load,expression:"load"}],staticStyle:{display:"block","scroll-behavior":"smooth !important"},attrs:{"show-header":!1,data:e.mvs,height:"100vh","infinite-scroll-immediate":!1}},[n("el-table-column",{attrs:{label:"mv1"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row[0]?n("MVCard",{attrs:{mvid:t.row[0].id}}):e._e()]}}])}),n("el-table-column",{attrs:{label:"mv2"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row[1]?n("MVCard",{attrs:{mvid:t.row[1].id}}):e._e()]}}])}),n("el-table-column",{attrs:{label:"mv3"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row[2]?n("MVCard",{attrs:{mvid:t.row[2].id}}):e._e()]}}])}),n("el-table-column",{attrs:{label:"mv4"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row[3]?n("MVCard",{attrs:{mvid:t.row[3].id}}):e._e()]}}])}),n("el-table-column",{attrs:{label:"mv5"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row[4]?n("MVCard",{attrs:{mvid:t.row[4].id}}):e._e()]}}])})],1)},Z=[],q=(n("a434"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",{staticClass:"mv-card",attrs:{"body-style":{padding:"0px"},shadow:"hover"}},[n("transition",{attrs:{name:"fade",mode:"out-in"}},[e.expand?n("el-image",{staticStyle:{width:"298px",height:"167px"},attrs:{src:e.genUrl(e.mv.backdrop_path),fit:"fill"},nativeOn:{click:function(t){e.expand=!e.expand}}}):n("el-image",{staticStyle:{width:"298px",height:"447px"},attrs:{src:e.genUrl(e.mv.poster_path),fit:"fill"},nativeOn:{click:function(t){e.expand=!e.expand}}})],1),e.expand?n("el-col",{staticClass:"mv-card-main"},[n("el-row",{staticClass:"mv-title-row"},[n("el-col",{staticClass:"mv-title"},[e._v(" "+e._s(e.mv.title)+" ")])],1),n("el-row",[n("el-col",{attrs:{span:18}},[n("el-image",{staticStyle:{width:"43px",height:"16px","margin-right":"5px",top:"5px"},attrs:{src:e.mv.production_companies.filter((function(e){return null!=e.logo_path})).length>0?e.genUrl(e.mv.production_companies.filter((function(e){return null!=e.logo_path})).sort((function(e,t){return e.id-t.id}))[0].logo_path):"",fit:"scale-down"}}),n("el-divider",{attrs:{direction:"vertical"}}),n("span",[e._v(e._s(e.mv.release_date))]),n("el-divider",{attrs:{direction:"vertical"}}),n("span",[e._v(e._s(e.mv.runtime)+" min")])],1),n("el-col",{staticStyle:{"text-align":"right","padding-right":"20px"},attrs:{span:6}},[n("el-popconfirm",{attrs:{title:"Confirm to delete?","confirm-button-text":"Yes","cancel-button-text":"Cancel"},on:{confirm:e.deleteMV}},[n("el-button",{staticStyle:{padding:"5px"},attrs:{slot:"reference",type:"danger",icon:"el-icon-delete",circle:""},slot:"reference"})],1)],1)],1),n("el-row",[n("el-divider",{staticClass:"mv-divider"}),n("span",{staticClass:"movie-overview"},[e._v(e._s(e.mv.overview))])],1),e.dateCompare(e.mv.release_date)?n("el-row",{staticClass:"mark-button"},[n("el-col",{staticStyle:{"line-height":"40px","padding-right":"10px"},attrs:{span:20}},[e.mv.isFinished?n("span",[e._v("Watched on ")]):e._e(),n("el-date-picker",{staticClass:"date-picker",attrs:{align:"right",type:"date",size:"mini","picker-options":e.pickerOptions},on:{change:e.changeFinishedDate},model:{value:e.finishedDate,callback:function(t){e.finishedDate=t},expression:"finishedDate"}})],1),n("el-col",{attrs:{span:2}},[n("el-button",{attrs:{icon:"el-icon-check",type:e.mv.isFinished?"primary":"",circle:""},on:{click:function(t){e.mv.isFinished?e.unmarkWatchedMV():e.markWatchedMV()}}})],1)],1):e._e()],1):e._e()],1)}),X=[],Q={name:"MVCard",props:{mvid:Number},data:function(){var e=this;return{finishedDate:"",expand:!1,backdrop_path:"https://image.tmdb.org/t/p/original/wzJRB4MKi3yK138bJyuL9nx47y6.jpg",poster_path:"https://image.tmdb.org/t/p/original/k68nPLbIST6NP96JmTxmZijEvCA.jpg",pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()},shortcuts:[{text:"Today",onClick:function(e){e.$emit("pick",new Date)}},{text:"Yesterday",onClick:function(e){e.$emit("pick",(new Date).setTime((new Date).getTime()-864e5))}},{text:"Week Ago",onClick:function(e){e.$emit("pick",(new Date).setTime((new Date).getTime()-6048e5))}},{text:"Released Date",onClick:function(t){t.$emit("pick",e.mv.release_date)}}]}}},mounted:function(){this.finishedDate=this.mv.finishedDate},computed:{mvidx:function(){return this.$store.getters.getMVIdxByID(this.mvid)},mv:function(){return this.$store.getters.getMVByIdx(this.mvidx)}},methods:{genUrl:function(e){return"https://image.tmdb.org/t/p/original".concat(e)},dateCompare:function(e){return new Date(e).getTime()<(new Date).getTime()},unmarkWatchedMV:function(){this.$store.dispatch("unmarkWatchedMV",this.mvid)},markWatchedMV:function(){this.$store.dispatch("markWatchedMV",this.mvid)},deleteMV:function(){this.$store.dispatch("deleteMV",this.mvid)},changeFinishedDate:function(){console.log("onchange",this.finishedDate),this.$store.dispatch("changeMVFinishedDate",{mvidx:this.mvidx,date:JSON.parse(JSON.stringify(this.finishedDate))})}}},ee=Q,te=(n("d3f2"),Object(r["a"])(ee,q,X,!1,null,null,null)),ne=te.exports,se={name:"MVTable",components:{MVCard:ne},directives:{"el-table-infinite-scroll":L["a"]},computed:{mode:function(){return this.$store.getters.getMVMode},search:function(){return this.$store.getters.getMVSearch},sort:function(){var e={LE:function(e,t){return new Date(t.finishedDate?t.finishedDate:t.addDate).getTime()-new Date(e.finishedDate?e.finishedDate:e.addDate).getTime()},AZ:function(e,t){return e.title>t.title?1:t.title>e.title?-1:0},ZA:function(e,t){return e.title<t.title?1:t.title<e.title?-1:0},NO:function(e,t){return null!=e.release_date&&null!=t.release_date?new Date(t.release_date).getTime()-new Date(e.release_date).getTime():null==e.release_date&&null==t.release_date?0:null==e.release_date?1:null==t.release_date?-1:void 0},ON:function(e,t){return null!=e.release_date&&null!=t.release_date?new Date(e.release_date).getTime()-new Date(t.release_date).getTime():null==e.release_date&&null==t.release_date?0:null==e.release_date?1:null==t.release_date?-1:void 0}};return e[this.$store.getters.getMVSort]},mvs:function(){var e=this,t=JSON.parse(JSON.stringify(this.$store.getters.getMVsByMode(this.mode?this.mode:"listed").filter((function(t){return t.title.toLowerCase().includes(e.search.toLowerCase())})).sort(this.sort).slice(0,this.loader))),n=[];while(t.length)n.push(t.splice(0,5));return n}},methods:{load:function(){this.loader+=5}},data:function(){return{loader:15}}},ae=se,ie=Object(r["a"])(ae,H,Z,!1,null,null,null),re=ie.exports,oe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",{attrs:{gutter:20,type:"flex",justify:"end"}},[n("el-col",{attrs:{span:6}},[n("Add")],1),n("el-col",{attrs:{span:8}},[n("BackupRecover",{attrs:{span:5}})],1),n("el-col",{attrs:{span:7}},[e.$store.getters.getMode?n("SortTV"):n("SortMV")],1),n("el-col",{attrs:{span:3}},[n("StatDrawer")],1)],1)},ce=[],ue=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-button",{attrs:{type:"primary",round:""},on:{click:function(t){e.dialogFormVisible=!0}}},[e._v(" Add ")]),n("el-dialog",{attrs:{title:"Add a new "+(e.tmode?"TV":"Movie"),visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("el-form",{staticClass:"ruleForm",attrs:{model:e.form,"label-width":"100px"}},[n("el-form-item",{attrs:{label:"Show Name"}},[n("el-autocomplete",{staticClass:"inline-input",attrs:{"fetch-suggestions":e.querySearch,placeholder:"The Movie name","trigger-on-focus":!1,debounce:900},on:{select:e.handleSelect},scopedSlots:e._u([{key:"default",fn:function(t){var s=t.item;return[n("el-row",{staticClass:"row_item",attrs:{gutter:10}},[n("el-col",{attrs:{span:4}},[n("el-image",{staticStyle:{width:"100px",height:"50px"},attrs:{src:s.backdrop_path,fit:"scale-down",lazy:""}},[n("div",{staticClass:"image-slot",attrs:{slot:"error"},slot:"error"},[n("i",{staticClass:"el-icon-picture-outline"})])])],1),n("el-col",{attrs:{span:20}},[n("el-row",{staticClass:"preview_name"},[e._v(e._s(s.value))]),n("el-row",{staticClass:"preview_data"},[e._v(e._s(s.date))])],1)],1),n("el-divider",{staticClass:"preview_divider"})]}}]),model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}},[n("el-button",{attrs:{slot:"append",type:"text",disabled:""},slot:"append"},[e._v(" TMDB id : "+e._s(e.id)+" ")])],1)],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("Cancel")]),n("el-button",{attrs:{type:"primary"},on:{click:e.onSubmit}},[e._v("Confirm")])],1)],1)],1)},de=[],le=(n("d81d"),n("96cf"),n("1da1")),me=n("0f97"),pe=me("json"),he={name:"AddMV",data:function(){return{dialogFormVisible:!1,form:{name:""},id:0}},methods:{querySearch:function(e,t){var n=this,s=encodeURI(e);Object(le["a"])(regeneratorRuntime.mark((function e(){var a,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,pe(n.tmode?"https://api.themoviedb.org/3/search/tv?api_key=".concat(n.$store.getters.getAPI,"&language=en-US&page=1&query=").concat(s,"&include_adult=false"):"https://api.themoviedb.org/3/search/movie?api_key=".concat(n.$store.getters.getAPI,"&language=en-US&page=1&query=").concat(s,"&include_adult=false"));case 2:a=e.sent,i=a.results.map((function(e){return{value:n.tmode?e.name:e.title,id:e.id,date:n.tmode?e.first_air_date:e.release_date,backdrop_path:"https://image.tmdb.org/t/p/w200/".concat(e.backdrop_path)}})),t(i);case 5:case"end":return e.stop()}}),e)})))()},handleSelect:function(e){this.id=e.id},onSubmit:function(){this.dialogFormVisible=!1,this.$store.dispatch(this.tmode?"addTV":"addMV",this.id)}},computed:{tmode:function(){return this.$store.getters.getMode}}},fe=he,ge=(n("91a1"),Object(r["a"])(fe,ue,de,!1,null,null,null)),ve=ge.exports,be=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dropdown",{on:{command:e.handleCommand}},[n("el-button",{attrs:{type:"primary",round:""}},[e._v(" Sort"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"LE"}},[e._v("Last Wathced")]),n("el-dropdown-item",{attrs:{command:"AZ"}},[e._v("Name A to Z")]),n("el-dropdown-item",{attrs:{command:"ZA"}},[e._v("Name Z to A")]),n("el-dropdown-item",{attrs:{command:"LH"}},[e._v("Progress Low to Hight")]),n("el-dropdown-item",{attrs:{command:"HL"}},[e._v("Progress High to Low")]),n("el-dropdown-item",{attrs:{command:"NO"}},[e._v("Next Date New to Old")]),n("el-dropdown-item",{attrs:{command:"ON"}},[e._v("Next Date Old to New")])],1)],1)},_e=[],we={name:"SortTV",methods:{handleCommand:function(e){this.$store.commit("setTVSort",e)}}},De=we,xe=Object(r["a"])(De,be,_e,!1,null,null,null),ye=xe.exports,Te=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dropdown",{on:{command:e.handleCommand}},[n("el-button",{attrs:{type:"primary",round:""}},[e._v(" Sort"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"LE"}},[e._v("Last Watch")]),n("el-dropdown-item",{attrs:{command:"AZ"}},[e._v("Name A to Z")]),n("el-dropdown-item",{attrs:{command:"ZA"}},[e._v("Name Z to A")]),n("el-dropdown-item",{attrs:{command:"NO"}},[e._v("Release Date New to Old")]),n("el-dropdown-item",{attrs:{command:"ON"}},[e._v("Release Date Old to New")])],1)],1)},ke=[],Me={name:"SortMV",methods:{handleCommand:function(e){this.$store.commit("setMVSort",e)}}},Se=Me,Ve=Object(r["a"])(Se,Te,ke,!1,null,null,null),Ce=Ve.exports,$e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dropdown",{on:{command:e.handleCommand}},[n("el-button",{attrs:{type:"primary",round:""}},[e._v(" B & R"),n("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),n("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[n("el-dropdown-item",{attrs:{command:"dl"}},[e._v("Download Backup")]),n("el-dropdown-item",{attrs:{command:"ul"}},[e._v("Recover from Backup")]),n("el-dropdown-item",{attrs:{command:"cdl"}},[e._v("Sync to Gist")]),n("el-dropdown-item",{attrs:{command:"cul"}},[e._v("Recover from Gist")])],1),n("el-dialog",{attrs:{title:"Upload JSON Backup File",visible:e.dialogTableVisible,width:"30%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[n("el-upload",{staticClass:"upload-demo",attrs:{drag:"",action:"",multiple:!1,"file-list":e.fileList,accept:".json","http-request":e.handleFile,limit:1}},[n("i",{staticClass:"el-icon-upload"}),n("div",{staticClass:"el-upload__text"},[e._v(" Drag your JSON here，or "),n("em",[e._v("Click to upload")])]),n("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("JSON file only")])]),n("el-button",{staticClass:"ul-button",attrs:{type:"primary"},on:{click:function(t){e.dialogTableVisible=!1}}},[e._v("Finish")])],1)],1)},Oe=[],Ne=(n("d3b7"),n("3ca3"),n("ddb0"),n("2b3d"),n("ade3")),Fe={name:"BackupRecover",data:function(){return{dialogTableVisible:!1,fileList:[]}},created:function(){},methods:{dlJson:function(){var e=JSON.stringify(this.$store.getters.getSaveData),t=new Blob([e],{type:"text/plain"}),n=document.createElement("a");n.download="PumpkinTVSave.json",n.href=window.URL.createObjectURL(t),n.click(),URL.revokeObjectURL(n.href)},dlGist:function(){var e=this;return Object(le["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:fetch("https://api.github.com/gists/".concat(e.$store.getters.getGist),{method:"PATCH",headers:{Accept:"application/vnd.github.v3+json",Authorization:"bearer ".concat(e.$store.getters.getToken," ")},body:JSON.stringify({description:"PumpkinTV saved progress",public:!1,files:Object(Ne["a"])({},"PumpkinTVSave.json",{content:JSON.stringify(e.$store.getters.getSaveData)})})}).then((function(e){return e.json()})).then((function(e){return console.log(e)}));case 1:case"end":return t.stop()}}),t)})))()},ulGist:function(){var e=this;return Object(le["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:fetch("https://api.github.com/gists/".concat(e.$store.getters.getGist),{method:"GET",headers:{Accept:"application/vnd.github.v3+json",Authorization:"bearer ".concat(e.$store.getters.getToken)}}).then((function(e){return e.json()})).then((function(t){return e.$store.dispatch("recoverFromSave",JSON.parse(t.files["PumpkinTVSave.json"].content))}));case 1:case"end":return t.stop()}}),t)})))()},handleFile:function(e){var t=this;console.log(e);var n=new FileReader;n.readAsText(e.file),n.onload=function(){var n=Object(le["a"])(regeneratorRuntime.mark((function n(s){return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.prev=0,t.$store.commit("recoverFromSave",JSON.parse(s.target.result)),console.log(t.$store.getters.getUserData),n.next=5,e.onSuccess();case 5:n.next=10;break;case 7:n.prev=7,n.t0=n["catch"](0),console.log("Load JSON file error: ".concat(n.t0.message));case 10:case"end":return n.stop()}}),n,null,[[0,7]])})));return function(e){return n.apply(this,arguments)}}()},handleCommand:function(e){"dl"===e?this.dlJson():"ul"===e?this.dialogTableVisible=!0:"cdl"==e?this.dlGist():"cul"==e&&this.ulGist()}}},Ie=Fe,Ae=(n("842d"),Object(r["a"])(Ie,$e,Oe,!1,null,null,null)),Be=Ae.exports,We=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-image",{staticClass:"avatar-bar",attrs:{src:e.avatar},on:{click:function(t){e.drawer=!0}}}),n("el-drawer",{ref:"drawer",attrs:{title:"stat",visible:e.drawer,"with-header":!1},on:{"update:visible":function(t){e.drawer=t}}},[n("el-row",[n("el-image",{staticClass:"avatar-large",attrs:{src:e.avatar}})],1),n("el-row",{staticClass:"drawer-title"},[n("span",[e._v(e._s(e.$store.getters.getUsername))])]),n("el-divider"),n("el-carousel",{attrs:{height:"calc(100vh - 167px)",direction:"vertical",autoplay:!0}},[n("el-carousel-item",{key:"tv"},[n("StatCarousel",{attrs:{tmode:!0}})],1),n("el-carousel-item",{key:"mv"},[n("StatCarousel",{attrs:{tmode:!1}})],1)],1)],1)],1)},je=[],Ue=n("3835"),Ee=(n("c037"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("el-row",[n("el-col",{attrs:{span:12}},[n("el-row",{staticClass:"drawer-title"},[n("span",[e._v(e._s(e.title)+" Watched")])]),n("el-row",{staticClass:"drawer-number"},[n("span",[e._v(e._s(e.tmode?e.$store.getters.getTotalWatchedTV:e.$store.getters.getTotalWatchedMV))])])],1),n("el-col",{attrs:{span:12}},[n("el-row",{staticClass:"drawer-title"},[n("span",[e._v(e._s(e.title)+" Time")])]),n("el-row",{staticClass:"drawer-number"},[n("span",[e._v(e._s(e.genTime(e.watchedTime)))])])],1)],1),n("el-divider"),n("el-carousel",{attrs:{height:"500px",autoplay:!1}},[n("el-carousel-item",{key:"added"},[n("el-row",{staticClass:"drawer-title"},[n("span",[e._v(e._s(e.title)+" Added")])]),n("el-row",{staticClass:"drawer-number"},[n("span",[e._v(e._s(e.number))])]),n("el-row",[n("v-chart",{attrs:{options:e.tmode?e.tvsAddedChart:e.mvsAddedChart}})],1)],1),n("el-carousel-item",{key:"time"},[n("el-row",{staticClass:"drawer-title"},[n("span",[e._v(e._s(e.title)+" Time per ")]),n("el-button",{staticClass:"drawer-title",attrs:{type:"text"},on:{click:e.changeScale}},[e._v(e._s(e.scale[e.scaleidx]))])],1),n("el-row",[n("v-chart",{attrs:{options:e.tmode?e.tvsTimeChart:e.mvsTimeChart}})],1)],1),n("el-carousel-item",{key:"number"},[n("el-row",{staticClass:"drawer-title"},[n("span",[e._v(e._s(e.title)+" Number per ")]),n("el-button",{staticClass:"drawer-title",attrs:{type:"text"},on:{click:e.changeScale}},[e._v(e._s(e.scale[e.scaleidx]))])],1),n("el-row",[n("v-chart",{attrs:{options:e.tmode?e.tvsNumberChart:e.mvsNumberChart}})],1)],1)],1)],1)}),Je=[];n("a630"),n("94b1");Date.prototype.getWeekNumber=function(){var e=new Date(Date.UTC(this.getFullYear(),this.getMonth(),this.getDate())),t=e.getUTCDay()||7;e.setUTCDate(e.getUTCDate()+4-t);var n=new Date(Date.UTC(e.getUTCFullYear(),0,1));return Math.ceil(((e-n)/864e5+1)/7)};var Re={name:"StatCarousel",data:function(){return{scaleidx:0,scale:["Week","Month","Year"],months:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}},props:{tmode:Boolean},methods:{changeScale:function(){return this.scaleidx+=1,this.scaleidx>2&&(this.scaleidx=0),this.scaleidx},genTime:function(e){var t=Object(Ue["a"])(e,3),n=t[0],s=t[1],a=t[2];return"".concat(n,"M ").concat(s,"D ").concat(a,"H")},getMonthIdx:function(e){return e>11?e-=12:e<0&&(e+=12),e},getWeekIdx:function(e){return e>52?e-=52:e<0&&(e+=52),e}},computed:{title:function(){return this.tmode?"TV":"Movie"},number:function(){return this.tmode?this.$store.getters.getTVNumber:this.$store.getters.getMVNumber},watchedTime:function(){return this.tmode?this.$store.getters.getTVWatchedTime:this.$store.getters.getMVWatchedTime},tvsAddedChart:function(){return{series:{name:"Added Shows",type:"pie",radius:["60%","80%"],label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"30",fontWeight:"bold"}},data:[{name:"Catching \n ".concat(this.$store.getters.getTVsByMode("catching").length),value:this.$store.getters.getTVsByMode("catching").length},{name:"Following \n ".concat(this.$store.getters.getTVsByMode("following").length),value:this.$store.getters.getTVsByMode("following").length},{name:"Finished \n ".concat(this.$store.getters.getTVsByMode("finished").length),value:this.$store.getters.getTVsByMode("finished").length},{name:"Waiting \n ".concat(this.$store.getters.getTVsByMode("Waiting").length),value:this.$store.getters.getTVsByMode("Waiting").length},{name:"Others \n ".concat(this.$store.getters.getTVsByMode("notstart").length+this.$store.getters.getTVsByMode("upcoming").length+this.$store.getters.getTVsByMode("stopped").length),value:this.$store.getters.getTVsByMode("notstart").length+this.$store.getters.getTVsByMode("upcoming").length+this.$store.getters.getTVsByMode("stopped").length}]}}},mvsAddedChart:function(){return{series:{name:"Added Movies",type:"pie",radius:["60%","80%"],label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"30",fontWeight:"bold"}},data:[{name:"Watched \n ".concat(this.$store.getters.getMVsByMode("watched").length),value:this.$store.getters.getMVsByMode("watched").length},{name:"Listed \n ".concat(this.$store.getters.getMVsByMode("listed").length),value:this.$store.getters.getMVsByMode("listed").length},{name:"Upcoming \n ".concat(this.$store.getters.getMVsByMode("upcoming").length),value:this.$store.getters.getMVsByMode("upcoming").length}]}}},mvsTimeChart:function(){var e=this;return{xAxis:{data:Array.from({length:12},(function(t,n){return 0==e.scaleidx?e.getWeekIdx((new Date).getWeekNumber()-11+n)+1:1==e.scaleidx?e.months[e.getMonthIdx((new Date).getMonth()-11+n)]:(new Date).getFullYear()-11+n})),splitLine:{show:!1}},yAxis:{},series:{name:"time",type:"bar",label:{show:!0,position:"top"},data:Array.from({length:12},(function(t,n){return e.$store.getters.getMVWatchedTimeBy(e.scaleidx,0==e.scaleidx?e.getWeekIdx((new Date).getWeekNumber()-11+n):1==e.scaleidx?e.getMonthIdx((new Date).getMonth()-11+n):(new Date).getFullYear()-11+n)}))}}},tvsTimeChart:function(){var e=this;return{xAxis:{data:Array.from({length:12},(function(t,n){return 0==e.scaleidx?e.getWeekIdx((new Date).getWeekNumber()-11+n)+1:1==e.scaleidx?e.months[e.getMonthIdx((new Date).getMonth()-11+n)]:(new Date).getFullYear()-11+n})),splitLine:{show:!1}},yAxis:{},series:{name:"time",type:"bar",label:{show:!0,position:"top"},data:Array.from({length:12},(function(t,n){return e.$store.getters.getTVWatchedTimeBy(e.scaleidx,0==e.scaleidx?e.getWeekIdx((new Date).getWeekNumber()-11+n):1==e.scaleidx?e.getMonthIdx((new Date).getMonth()-11+n):(new Date).getFullYear()-11+n)}))}}},mvsNumberChart:function(){var e=this;return{xAxis:{data:Array.from({length:12},(function(t,n){return 0==e.scaleidx?e.getWeekIdx((new Date).getWeekNumber()-11+n)+1:1==e.scaleidx?e.months[e.getMonthIdx((new Date).getMonth()-11+n)]:(new Date).getFullYear()-11+n})),splitLine:{show:!1}},yAxis:{},series:{name:"time",type:"bar",label:{show:!0,position:"top"},data:Array.from({length:12},(function(t,n){return e.$store.getters.getMVWatchedNumberBy(e.scaleidx,0==e.scaleidx?e.getWeekIdx((new Date).getWeekNumber()-11+n):1==e.scaleidx?e.getMonthIdx((new Date).getMonth()-11+n):(new Date).getFullYear()-11+n)}))}}},tvsNumberChart:function(){var e=this;return{xAxis:{data:Array.from({length:12},(function(t,n){return 0==e.scaleidx?e.getWeekIdx((new Date).getWeekNumber()-11+n)+1:1==e.scaleidx?e.months[e.getMonthIdx((new Date).getMonth()-11+n)]:(new Date).getFullYear()-11+n})),splitLine:{show:!1}},yAxis:{},series:{name:"time",type:"bar",label:{show:!0,position:"top"},data:Array.from({length:12},(function(t,n){return e.$store.getters.getTVWatchedNumberBy(e.scaleidx,0==e.scaleidx?e.getWeekIdx((new Date).getWeekNumber()-11+n):1==e.scaleidx?e.getMonthIdx((new Date).getMonth()-11+n):(new Date).getFullYear()-11+n)}))}}}}},Pe=Re,Le=Object(r["a"])(Pe,Ee,Je,!1,null,null,null),Ye=Le.exports,Ge={name:"StatDrawer",components:{StatCarousel:Ye},data:function(){return{drawer:!1}},methods:{handleDrawer:function(){console.log(this.drawer),this.drawer=!0},genTime:function(e){var t=Object(Ue["a"])(e,3),n=t[0],s=t[1],a=t[2];return"".concat(n,"M ").concat(s,"D ").concat(a,"H")}},computed:{avatar:function(){return this.$store.getters.getAvatar},tvsChart:function(){return{series:{name:"Added Shows",type:"pie",radius:["60%","80%"],label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"30",fontWeight:"bold"}},data:[{name:"Catching \n ".concat(this.$store.getters.getTVsByMode("catching").length),value:this.$store.getters.getTVsByMode("catching").length},{name:"Following \n ".concat(this.$store.getters.getTVsByMode("following").length),value:this.$store.getters.getTVsByMode("following").length},{name:"Finished \n ".concat(this.$store.getters.getTVsByMode("finished").length),value:this.$store.getters.getTVsByMode("finished").length},{name:"Waiting \n ".concat(this.$store.getters.getTVsByMode("Waiting").length),value:this.$store.getters.getTVsByMode("Waiting").length},{name:"Others \n ".concat(this.$store.getters.getTVsByMode("notstart").length+this.$store.getters.getTVsByMode("upcoming").length+this.$store.getters.getTVsByMode("stopped").length),value:this.$store.getters.getTVsByMode("notstart").length+this.$store.getters.getTVsByMode("upcoming").length+this.$store.getters.getTVsByMode("stopped").length}]}}},mvsChart:function(){return{series:{name:"Added Movies",type:"pie",radius:["60%","80%"],label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"30",fontWeight:"bold"}},data:[{name:"Watched \n ".concat(this.$store.getters.getMVsByMode("watched").length),value:this.$store.getters.getMVsByMode("watched").length},{name:"Listed \n ".concat(this.$store.getters.getMVsByMode("listed").length),value:this.$store.getters.getMVsByMode("listed").length},{name:"Upcoming \n ".concat(this.$store.getters.getMVsByMode("upcoming").length),value:this.$store.getters.getMVsByMode("upcoming").length}]}}}}},Ke=Ge,ze=(n("b1a2"),Object(r["a"])(Ke,We,je,!1,null,null,null)),He=ze.exports,Ze={name:"FunctionBar",components:{Add:ve,SortTV:ye,SortMV:Ce,BackupRecover:Be,StatDrawer:He}},qe=Ze,Xe=(n("df26"),Object(r["a"])(qe,oe,ce,!1,null,null,null)),Qe=Xe.exports,et=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-menu",{staticClass:"el-menu-vertical",attrs:{"default-active":e.$store.getters.getTVMode},on:{select:e.handleSelect}},[n("el-menu-item",{attrs:{index:"all"}},[n("i",{staticClass:"el-icon-menu"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("All")])]),n("el-menu-item",{attrs:{index:"catching"}},[n("i",{staticClass:"el-icon-menu"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("Catching")])]),n("el-menu-item",{attrs:{index:"following"}},[n("i",{staticClass:"el-icon-menu"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("Following")])]),n("el-menu-item",{attrs:{index:"waiting"}},[n("i",{staticClass:"el-icon-menu"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("Waiting")])]),n("el-menu-item",{attrs:{index:"upcoming"}},[n("i",{staticClass:"el-icon-menu"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("Upcoming")])]),n("el-menu-item",{attrs:{index:"finished"}},[n("i",{staticClass:"el-icon-menu"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("Finished")])]),n("el-menu-item",{attrs:{index:"notstart"}},[n("i",{staticClass:"el-icon-menu"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("Haven't Start")])]),n("el-menu-item",{attrs:{index:"stopped"}},[n("i",{staticClass:"el-icon-menu"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("Stopped")])])],1)},tt=[],nt={name:"NavMenu",methods:{handleSelect:function(e){this.$store.commit("setTVMode",e)}}},st=nt,at=(n("019b"),Object(r["a"])(st,et,tt,!1,null,null,null)),it=at.exports,rt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-menu",{staticClass:"el-menu-vertical",attrs:{"default-active":e.$store.getters.getMVMode},on:{select:e.handleSelect}},[n("el-menu-item",{attrs:{index:"all"}},[n("i",{staticClass:"el-icon-menu"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("All")])]),n("el-menu-item",{attrs:{index:"listed"}},[n("i",{staticClass:"el-icon-menu"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("Listed")])]),n("el-menu-item",{attrs:{index:"watched"}},[n("i",{staticClass:"el-icon-menu"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("Watched")])]),n("el-menu-item",{attrs:{index:"upcoming"}},[n("i",{staticClass:"el-icon-menu"}),n("span",{attrs:{slot:"title"},slot:"title"},[e._v("Upcoming")])])],1)},ot=[],ct={name:"NavMenuMV",methods:{handleSelect:function(e){this.$store.commit("setMVMode",e)}}},ut=ct,dt=(n("8c13"),Object(r["a"])(ut,rt,ot,!1,null,null,null)),lt=dt.exports,mt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-input",{staticClass:"inline-input",attrs:{placeholder:"The "+(e.tmode?"TV show":"Movie")+" name","trigger-on-focus":!1,debounce:900,clearable:!0},on:{input:e.handleSearch},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})},pt=[],ht={name:"SearchBar",data:function(){return{search:""}},computed:{tmode:function(){return this.$store.getters.getMode}},methods:{handleSearch:function(){this.$store.commit(this.tmode?"setTVSearch":"setMVSearch",this.search)}}},ft=ht,gt=Object(r["a"])(ft,mt,pt,!1,null,null,null),vt=gt.exports,bt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:"Welcome to use PumpkinTV.",visible:e.apiKeyExist},on:{"update:visible":function(t){e.apiKeyExist=t}}},[n("el-form",{attrs:{model:e.form}},[n("el-alert",{staticStyle:{"margin-bottom":"10px"},attrs:{title:"I need a TMDB API key to sync shows data.",type:"warning","show-icon":""}}),n("el-form-item",{attrs:{label:"API KEY","label-width":"120px"}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.apiKey,callback:function(t){e.$set(e.form,"apiKey",t)},expression:"form.apiKey"}})],1),n("el-alert",{staticStyle:{"margin-bottom":"10px"},attrs:{title:"I can also use your github account to save your progress to Gist. I will\n    only use those info locally.",type:"warning","show-icon":""}}),n("el-form-item",{attrs:{label:"GitHub Login","label-width":"120px"}},[n("el-button",[n("a",{attrs:{href:"https://github.com/login/oauth/authorize?\nclient_id=4a56fb45e857832a9fae&redirect_uri=https://pumpkincheshire.github.io/PumpkinTV/#/oauth&scope=gist"}},[e._v("Github")])])],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:e.handleForm}},[e._v("Confirm")])],1)],1)},_t=[],wt={name:"Init",data:function(){return{apiKeyExist:!1,form:{apiKey:""}}},mounted:function(){var e=this;setTimeout((function(){e.apiKeyExist=""==e.$store.getters.getAPI}),5e3)},methods:{handleForm:function(){this.$store.dispatch("setApiKey",this.form.apiKey),this.apiKeyExist=""==this.$store.getters.getAPI}}},Dt=wt,xt=Object(r["a"])(Dt,bt,_t,!1,null,null,null),yt=xt.exports,Tt={name:"app",components:{TVTable:z,MVTable:re,FunctionBar:Qe,TVNavMenu:it,MVNavMenu:lt,SearchBar:vt,Init:yt},computed:{tmode:function(){return this.$store.getters.getMode}},methods:{changeMode:function(){this.$store.commit("changeMode")}}},kt=Tt,Mt=(n("034f"),Object(r["a"])(kt,g,v,!1,null,null,null)),St=Mt.exports,Vt=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[e._v("Logging in")])},Ct=[],$t=(n("5319"),{name:"Oauth",beforeCreate:function(){console.log("I am processing oauth"),console.log(this.$store.state.loginCode),this.$store.dispatch("setAccessToken",this.$route.query.code),console.log(this.$store.getters.getLoginCode),this.$router.replace({name:"root"})}}),Ot=$t,Nt=Object(r["a"])(Ot,Vt,Ct,!1,null,null,null),Ft=Nt.exports;s["default"].use(f["a"]);var It=[{path:"/",name:"root",component:St},{path:"/oauth",name:"oauth",component:Ft}],At=new f["a"]({base:"/PumpkinTV/",routes:It}),Bt=At,Wt=(n("f689"),n("9ca8"));s["default"].config.productionTip=!1,s["default"].component("v-chart",Wt["a"]),s["default"].use(L["a"]),new s["default"]({router:Bt,store:h["a"],render:function(e){return e(u)}}).$mount("#app")},"631e":function(e,t,n){"use strict";n("8dd1")},"7e1e":function(e,t,n){},"842d":function(e,t,n){"use strict";n("cc8e")},"85ec":function(e,t,n){},"8c13":function(e,t,n){"use strict";n("7e1e")},"8dd1":function(e,t,n){},"91a1":function(e,t,n){"use strict";n("b07b")},b07b:function(e,t,n){},b1a2:function(e,t,n){"use strict";n("cb65")},bd05:function(e,t,n){"use strict";n("dc91")},cb65:function(e,t,n){},cc8e:function(e,t,n){},d3f2:function(e,t,n){"use strict";n("f14a")},d842:function(e,t,n){},dc91:function(e,t,n){},df26:function(e,t,n){"use strict";n("d842")},f14a:function(e,t,n){},f236:function(e,t,n){},f689:function(e,t,n){}});
//# sourceMappingURL=app.1ecf1576.js.map